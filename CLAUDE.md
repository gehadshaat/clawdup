# Clawdup

Automated pipeline that polls ClickUp for tasks, uses Claude Code to implement them, and creates GitHub PRs.

## Tech Stack

- **Language:** TypeScript 5.8 (strict mode), targeting ES2022
- **Runtime:** Node.js 18+ (uses native `fetch`)
- **Module system:** ESM (`"type": "module"`, NodeNext resolution)
- **External tools:** Git CLI, GitHub CLI (`gh`), Claude Code CLI (`claude`)
- **No runtime dependencies** — only `@types/node` and `typescript` as dev dependencies

## Project Structure

```
src/
  cli.ts          # CLI entry point, argument parsing, --check/--setup/--init
  config.ts       # Configuration loading (env → .clawdup.env → clawdup.config.mjs)
  types.ts        # TypeScript interfaces (ClickUpTask, ClaudeResult, etc.)
  clickup-api.ts  # ClickUp API v2 REST client
  git-ops.ts      # Git and GitHub CLI operations (branch, commit, push, PR)
  claude-worker.ts # Claude Code invocation, JSONL stream parsing, prompt building
  runner.ts       # Main orchestration engine, task lifecycle, polling loop
  setup.ts        # Interactive setup wizard
  index.ts        # Public API exports
bin/
  clawdup.js       # CLI shim (#!/usr/bin/env node)
dist/             # Compiled output (generated by tsc)
```

## Commands

```bash
npm run build     # Compile TypeScript → dist/
```

There are no tests or linter configured. TypeScript strict mode is the primary correctness check.

## Coding Conventions

- **Naming:** camelCase for functions/variables, PascalCase for types/interfaces, SCREAMING_SNAKE_CASE for constants
- **Async:** Always use async/await (no raw Promise chains)
- **Imports:** Use `.js` extension in import paths (required by NodeNext module resolution)
- **Error handling:** try/catch with descriptive messages; non-critical failures log warnings but don't crash
- **Module pattern:** Each file has a focused responsibility with named exports
- **No default exports** — use named exports throughout

## Git Conventions

- **Commit format:** `[CU-{task-id}] {description}`
- **Branch format:** `{prefix}/CU-{task-id}-{slug}` (e.g., `clickup/CU-abc123-add-auth`)
- **Base branch:** `main`

## Key Architecture Decisions

- **Zero runtime deps:** Everything uses Node built-ins and shelled-out CLI tools
- **Stream-JSON parsing:** Claude Code output is consumed as JSONL for structured event processing
- **Security-first:** Task content from ClickUp is treated as untrusted input — prompt injection detection, content sanitization, and boundary markers are enforced (see [PROMPT_SAFETY.md](PROMPT_SAFETY.md) for full guidelines)
- **Config cascade:** Environment variables → `.clawdup.env` → `clawdup.config.mjs` → defaults
- **Monorepo aware:** Distinguishes PROJECT_ROOT (cwd) from GIT_ROOT (repo root) for monorepo support
